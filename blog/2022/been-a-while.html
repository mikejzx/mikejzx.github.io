<!DOCTYPE html>
<html lang="en">

	<head>
		<!-- Metadata -->
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description" content="Michael Skec's Personal Webpage"/>
		<meta name="keywords" content="mikejzx, skec, michael, mike, blog, site"/>
		<meta name="author" content="Michael Skec"/>
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>

		<!-- RSS feed -->
		<link rel="alternate" type="application/atom+xml" href="/rss.xml"/>

		<!-- Stylesheet -->
		<link rel="stylesheet" href="/css/styles.css" type="text/css"/>

		<!-- Page title -->
		<title>New Roff-based Blog System &ndash; Mike&rsquo;s Blog</title>
	</head>

	<body>

		<!-- Navbar -->
		<nav>
			<a href="/index.html">home</a>
			<a href="/blog/index.html">writings</a>
			<a href="/rss.xml">rss</a>
		</nav>
		<article>
			<header>
				<span class="sntc">New Roff&#45;based Blog System</span>
				<span style="float: right">2022-05-03</span>
			</header>
			<p class="sentspc">
				<span class="sntc">So, it&rsquo;s definitely been a good while since I last wrote anything here on my site.</span>
				<span class="sntc">Though, fear not!</span>
				<span class="sntc">I am back, after having completely re&#45;written my site from the ground up, I am no longer using <code>ssg5</code> and <code>rssg</code>, but rather a new Makefile&#45;based system I built up myself, using my own scripts and programs to generate this whole thing; as the old site system was just so ugly and messy that it had become essentially unmaintainable.</span>
				<span class="sntc">I think from hereon I&rsquo;ll try to make more of an effort to write more articles here in time&mdash;because as it stands, I feel like I am yet to have played my part in serving the web with actually interesting content&hellip;</span>
				<span class="sntc">Especially in our current world where the web is dominated by bloat, bombardment of obnoxious advertisements, trillion&#45;dollar corporations, social media, biased news, biased searches &#40;looking at you DuckDuckGo, for just recently hopping on the bandwagon too&#41;, SEO spam, and just plain rubbish content. I hope my site provides you with a breath of fresh air through the mostly text&#45;based content over here.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">The new site generation system is fairly straight&#45;forward.</span>
				<span class="sntc">As you&rsquo;d imagine; a nice source directory with HTML files for most things, a few &lsquo;templates&rsquo;, and the &lsquo;blog&rsquo; section with it&rsquo;s source files.</span>
				<span class="sntc">I have general rules in the Makefile which automate most things, like updating the stylesheet, copying over new files, and re&#45;compiling articles when they change, etc.</span>
				<span class="sntc">I also wrote a simple script that runs when articles are added or changed, that generates a nice RSS feed of the blog.</span>
				<span class="sntc">However, the main new interesting thing about the blog, is that I no longer need to write it using Markdown.</span>
				<span class="sntc">Instead, I now write these articles using a variation of the Roff &lsquo;ms&rsquo; macros!</span>
				<span class="sntc">&#40;Converted my old articles to the new format, though I skipped the small useless articles that have essentially lost all their relevance now&#41;.</span>
				<span class="sntc">This probably sounds incredibly stupid, and possibly even masochistic, but there is I think a possibly interesting reason I chose this format of all other formats.</span>
				<span class="sntc">The reason essentially boils down to typography.</span>
				<span class="sntc">If you&rsquo;ve got eagle eyes or if you pay particularly close attention to the typographic subtleties of content you read, then you may have noticed the specific effect I aimed for here.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">To put it explicitly, I was aiming for proper <i>sentence spacing</i> in my webpage.</span>
				<span class="sntc">I developed somewhat of a habit at some point last year where I started putting two spaces after sentences I was writing to indicate the end of sentences more clearly &#40;e.g. in plaintext documents&#41;; I have no idea how this habit started; but in general I feel like after I discovered and realised it was a thing, I found it a lot more aesthetically pleasing than the robotic word&#45;spacing&#45;after&#45;sentences that has become ever&#45;increasingly ubiquitous in modern times.</span>
				<span class="sntc">Perhaps it was also due to a desire to stick to a more conservative, &lsquo;traditional&rsquo; way of formatting text, which had unfortunately faded in the last few decades due to all sorts of reasons &#40;<a href="https://www.tomsarazac.com/tom/opinions/space-after-periods.html">see</a>&#41;, most notably of which here on the web was due to some technical limitations of HTML.</span>
				<span class="sntc">As of course, HTML normalises all whitespace between words into uniform spacing, the specification does not provide any <code>&lt;sentence&gt;</code> tag to use for this purpose, and there seemed to be very little concern for the typographic implications of this at the time.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">So to implement this new feature, my first idea was to just borrow the convention used in Roff for sentence separation, and use it in Markdown.</span>
				<span class="sntc">For the sake of brevity&mdash;for people who haven&rsquo;t used a Roff typesetting system before &#40;e.g. the GNU implementation, <code>groff</code>&#41;&mdash;I&rsquo;ll simply state that in Roff, you are expected to start sentences on a line of their own, to indicate to the typesetter that when a line ends with sentence&#45;ending punctuation such as a full&#45;stop, question mark, or exclamation mark, it is going to be the end of a sentence &#40;there is a workaround for situations where you <i>don&rsquo;t</i> want a line that ends with this kind of punctuation to be considered the end of a sentence, by using a zero&#45;width space escape character&#41;.</span>
				<span class="sntc">At first glance, one would assume that using this same convention for indicating the end of a sentence should be relatively straight&#45;forward to use in Markdown.</span>
				<span class="sntc">And indeed, you can write a basic &ldquo;Markdown&rdquo; parser that achieves this, finding the correct ends of sentences in <i>paragraphs</i> based on where the lines start and end.</span>
				<span class="sntc">However, the system would fall apart once list items are taken into consideration; and it was the thing I stumbled upon while I myself were having a go at writing a basic Markdown parser that did this.</span>
				<span class="sntc">In Markdown, lists items can only be defined on a single line.  However, in Roff, a &ldquo;list item&rdquo; is actually just an indented paragraph with a bullet point next to it, so it doesn&rsquo;t suffer from this problem.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">I feel like this cause of this issue goes back to the roots of what Markdown really was intended to be used for.</span>
				<span class="sntc">I had read an article not long ago on the web by Adam Hyde, where he poses the question <a href="https://www.adamhyde.net/whats-wrong-with-markdown/">&ldquo;What&rsquo;s wrong with Markdown?&rdquo;</a>, and puts forth a few points.</span>
				<span class="sntc">He expresses his view that Markdown generally has very limited use cases, and asserts that, &ldquo;Markdown isn&rsquo;t designed for creating HTML&rdquo;, which is a somewhat exaggerated claim, as John Gruber, the actual author of Markdown, introduces it <a href="https://daringfireball.net/projects/markdown/">on his site</a> &#40;which Hyde also links&#41; not only as &ldquo;a text&#45;to&#45;HTML conversion tool for web writers&rdquo;, but also notes that the structure of Markdown places a strong emphasis on being &ldquo;publishable as&#45;is, as plain text, without looking like it&rsquo;s been marked up with tags or formatting instructions&rdquo;, i.e. it should be possible to read a Markdown document in it&rsquo;s <i>verbatim</i> form &#40;as Hyde notes, though not to the extent that he suggests&#41;.</span>
				<span class="sntc">This in turn creates a format that needs to make compromises in it&rsquo;s ability to be converted to HTML, to allow for easy reading of the source content.</span>
				<span class="sntc">This, and the lack of a proper specification, are why there are so many &ldquo;variations&rdquo;, of Markdown in the wild&mdash;it seems almost as though each website has their own additions and exclusions to the format.</span>
				<span class="sntc">Another thing to note is that Markdown is more often converted to HTML than it is published as&#45;is, and hence there is more incentive to add more things that help in the HTML conversions, but also then create a compromise in the verbatim reading experience of the content &#40;inline links being a notable offender here&#41; which then defeats one of the original purposes of the format.</span>
				<span class="sntc">This is especially a problem when &ldquo;single biggest source of inspiration for Markdownâ€™s syntax is the format of plain text email.&rdquo;</span>
			</p>
			<p class="sentspc">
				<span class="sntc">I will note, that technically it could be possible to achieve this in Markdown, or any markup language for that matter; and that is through some kind of automatic sentence&#45;detection software.</span>
				<span class="sntc">The approach here would be to write up your document as you normally would, in Markdown or whatever, possibly generate the HTML from it to split it into paragraphs and list items and so on, then run some kind of post&#45;processor that looks at the content within each tag and attempts to split them into sentences.</span>
				<span class="sntc">This is definitely possible, I&rsquo;ve actually written some code for a project of mine that does this, a terminal Gemini client called <code>sr71</code> that interprets paragraphs as an array of words and applies the spacing on it&rsquo;s own; and is accurate in most cases for determining the end of sentences, via a few rules that I defined.</span>
				<span class="sntc">&#40;I also implemented, as an experiment, various other really nice typographic features into <code>sr71</code>, like a Knuth&#45;Plass approach to line breaking, which yields really nice text&#45;justification in the terminal, with hanging punctuation too&mdash;you should check it out if you too sometimes browse Geminispace or Gopherspace!&#41;</span>
				<span class="sntc">The obvious problem with the approach of automated sentence detection is that the software will inevitably make errors, as it&rsquo;s incredibly difficult to program a piece of software to detect literally every possible case of where a sentence would end.</span>
				<span class="sntc">Perhaps a solution like this is fine for reading content other people have written, but as the author of the text content, I feel like I should have the ability to specify where my sentences end.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">Another possible method of achieving this in Markdown or other languages, that <i>does</i> give the writer control over the situation, would be to define some kind of &lsquo;sentence&#45;end&rsquo; escape sequence.</span>
				<span class="sntc">This would work fine to achieve the desired effect, but in my opinion I think it&rsquo;d end up really detracting from the writing experience and in the case of Markdown, would contribute to the whole problem mentioned earlier about &lsquo;adding features to improve HTML output at the cost of readability in the source format&rsquo;.</span>
				<span class="sntc">I think it&rsquo;d be more trouble than it&rsquo;s worth and best to just leave something like Markdown behind, and focus on using a more versatile format.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">After establishing that Markdown was unsuitable for my needs, I immediately turned to the alternative I had considered beforehand, even before I started writing my parser program.</span>
				<span class="sntc">Roff had always been a system that I quite enjoyed writing in; being a traditional Unix document preparation system, it has a very nice and old&#45;school feel to it, and in some sense is designed to be compatible with the Unix computing ethos, having source formats that are very easily &lsquo;greppable&rsquo;, and compatible with other tools on Unix&#45;like systems.</span>
				<span class="sntc">However, while I enjoyed using Roff, I found that my uses for it had diminished somewhat after discovering LaTeX.</span>
				<span class="sntc">Using Roff over LaTeX when LaTeX was just as easily available at my fingertips was a bit like, in lieu of a better analogy; a sports car owner deciding to take his wife&rsquo;s family sedan to a drag strip; sure it might be fun in a while, but if you want a good performance you&rsquo;d instead take the latter.</span>
			</p>
			<p class="sentspc">
				<span class="sntc">Obviously, my system isn&rsquo;t a &lsquo;real&rsquo; Roff system&mdash;I&rsquo;m using a parser I wrote myself, instead of an actual Roff system like <code>groff</code>, which is actually a system with many more layers to it than one would think, and my macro set isn&rsquo;t an &lsquo;official&rsquo; one; it just takes heavy inspiration from the &lsquo;ms&rsquo; macros and includes my own additions to make it more usable for web writing and excludes things that I don&rsquo;t have a use for just yet.</span>
				<span class="sntc">Of course, we just criticised Markdown for this very thing; not being standardised and having loads of variations, but I think it&rsquo;s a lot more acceptable with Roff, as the system is somewhat intended to be used in this manner and you don&rsquo;t create any compromises that contradict the original purposes of the format, such as plaintext readability &#40;which doesn&rsquo;t at all seem to be a goal of any Roff macro packages&#41;.</span>
				<span class="sntc">The macros that are exclusive to my macro set can easily be recreated in a true Roff system, so it should be a reasonably trivial process to compile the source documents to other formats such as to plaintext, PDFs, etc.</span>
				<span class="sntc">One thing I should mention in case anyone wonders, is that I actually did somewhat consider beforehand to just compile my &lsquo;.ms&rsquo; source files to webpages using <code>groff</code>&rsquo;s provided &lsquo;grohtml&rsquo; driver.</span>
				<span class="sntc">The reason I didn&rsquo;t use it however was simply due to the reduced control I had over the output.</span>
				<span class="sntc">Not only would it be tricky to get <code>grohtml</code> to place all the necessary <code>&lt;span&gt;</code>&rsquo;s needed for the sentence&#45;spacing effect I mentioned before; I also generally just liked the fact that I could use a small program I had written myself, and have complete control over the output it produces.</span>
				<span class="sntc">Using a true Roff system here would yield essentially no benefits that I can think of, other than perhaps &lsquo;authenticity&rsquo;, which isn&rsquo;t really of concern for little webpages that barely anyone is even going to read in the first place!</span>
			</p>
			<p class="sentspc">
				<span class="sntc">I&rsquo;ll also just briefly mention the technique I used to achieve the nice sentence spacing feature with my parser in case anybody was wondering.</span>
				<span class="sntc">I discovered the method through an article posted in 2012 on the subject; <a href="https://hea-www.harvard.edu/~fine/Tech/html-sentences.html">here</a>.</span>
				<span class="sntc">It&rsquo;s an interesting read and outlines many different methods of achieving it, and comparing each method to determine the best approach at the moment.</span>
				<span class="sntc">As I alluded to earlier, it involves separating sentences into <code>&lt;span&gt;</code>&rsquo;s within the <code>&lt;p&gt;</code> paragraph tag, and then applying certain CSS rules to both elements.</span>
				<span class="sntc">To achieve correct spacing &#40;and for it to work properly with text justification&#41;, the sentence <code>&lt;span&gt;</code>&rsquo;s need to have their <code>word&#45;spacing</code> property set to zero, and the surrounding paragraph needs to have it&rsquo;s <code>word&#45;spacing</code> set to the amount of space you want between sentences.</span>
				<span class="sntc">That&rsquo;s essentially all there is to it.</span>
				<span class="sntc">It is a bit finnicky and possibly error&#45;prone when applying this method to raw HTML by hand, as you would need to type out <code>&lt;span class&#61;"sentence"&gt;</code> literally every time you need to separate a sentence which would probably be irritating to the point where you&rsquo;d probably forget what you&rsquo;re even writing about.</span>
				<span class="sntc">Unless of course you&rsquo;re a Vim user or something and would&rsquo;ve thought to set up some kind of mapping so that this sort of thing is all automated.</span>
				<span class="sntc">However, with a system that takes in source files like the one I have here, it works great and produces really nice results!</span>
			</p>
			<p class="sentspc">
				<span class="sntc">I&rsquo;ve made my Roff&#45;to&#45;HTML parser available on GitHub under a GPLv3 license, under the title &lsquo;<a href="https://github.com/mikejzx/broff.git">broff</a>&rsquo;, which sounded like a clever name at first, but sounds kind of stupid at the same time.</span>
				<span class="sntc">The idea was that it was meant to be a contraction of &lsquo;blog roff&rsquo; as I guess blogging is the intended purpose of it?</span>
				<span class="sntc">Maybe it could also be for &lsquo;web roff&rsquo;, I&rsquo;ll let whoever happens to stumble across it decide.</span>
			</p>
		</article>
	</body>
</html>
